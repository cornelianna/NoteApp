@model NoteApp.Models.Post
@using Microsoft.AspNetCore.Identity
@inject UserManager<User> UserManager

<!-- Postview form profile -->
<div class="view-post-container container mt-5">
    <div class="view-post-flex">
        <!-- Post Section (Left) -->
        <div class="post-content">
            <div class="post-card p-4">
                <!-- Post Header -->
                <div class="post-header d-flex align-items-center mb-4">
                    <div class="user-avatar me-3">
                        <img src="~/images/icon.svg" alt="User Avatar" class="rounded-circle" width="50" height="50">
                    </div>
                    <div>
                        <h5 class="username mb-1">@Model.Username</h5>
                        <small class="text-muted">Posted on @Model.CreatedAt.ToString("g")</small>
                    </div>
                </div>
                <!-- Post Content -->
                @if (Model.ImageData != null && Model.ImageData.Length > 0)
                {
                    <div class="post-image mb-4">
                        <img src="data:image/jpeg;base64,@Convert.ToBase64String(Model.ImageData)" alt="Post Image" class="img-fluid rounded">
                    </div>
                }
                <div class="post-info">
                    <p>@Model.Content</p>
                </div>
            </div>
        </div>    
        <!-- Comments Section (Right) -->
        <div class="comments-section">
            <div class="comments-box p-4">
                <h5 class="comments-header" aria-label="Comments section header">Comments</h5> 
                <hr>
                <!-- Comment Form -->
                <form asp-action="AddComment" method="post" class="comment-form mt-3" aria-label="Add comment form"> 
                    <input type="hidden" name="postId" value="@Model.Id" />
                    <input type="hidden" name="returnUrl" value="ViewPost" />
                    <textarea class="form-control" name="Content" placeholder="Add a comment" required></textarea> 
                    <button type="submit" class="submitcomment btn btn-primary mt-3" aria-label="Submit comment"/>Comment</button>
                </form>
                <div class="discussions" aria-label="Comments section"> 
                    <div class="comments-scrollable" aria-label="Scrollable comments list"> 
                    @foreach (var comment in Model.Comments) 
                    { 
                        <partial name="_CommentPartial" model="comment" />
                    } 
                    </div> 
                </div>
            </div>
        </div>
    </div>
</div>        